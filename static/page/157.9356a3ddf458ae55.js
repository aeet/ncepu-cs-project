"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[157],{7157:(k,y,o)=>{o.r(y),o.d(y,{StudentModule:()=>Z});var v=o(4715),p=o(2340),u=o(8989),h=o(4004),w=o(6715),t=o(4650),f=o(5156),z=o(5915),I=o(5957),T=o(6616),N=o(7044),P=o(1811),A=o(7360);const O=["simple"];function Q(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"button",3),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.studentAdd())}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}let C=(()=>{class i{_onReuseInit(e){this.setInit()}setInit(){this.service.init({path:this.path,title:this.title,schema:this.schema})}constructor(e,n,s){this.modal=e,this.http=n,this.service=s,this.schema={properties:{name:{type:"string",title:"\u59d3\u540d",ui:{widget:"string"}},sex:{type:"string",title:"\u6027\u522b",ui:{widget:"string"}},age:{type:"number",title:"\u5e74\u9f84",ui:{widget:"number"}},code:{type:"string",title:"\u8eab\u4efd\u8bc1\u53f7",ui:{widget:"string"}}}},this.title="\u5b66\u751f\u4fe1\u606f\u7ba1\u7406",this.path="student",this.columns=[{title:"\u59d3\u540d",index:"name",type:""},{title:"\u5e74\u9f84",index:"age",type:""},{title:"\u6027\u522b",index:"sex",type:""},{title:"\u8eab\u4efd\u8bc1\u53f7",index:"code",type:""}],this.buttons=[{text:"\u6dfb\u52a0\u5b9e\u8df5\u7ecf\u5386",click:a=>{let r={};const l=this.modal.create({nzTitle:"\u6dfb\u52a0\u5b9e\u8df5\u7ecf\u5386",nzContent:u.kJ,nzComponentParams:{schema:{},formData:{},button:null},nzOnOk:()=>(r={...r,edges:{student:{id:a.id}}},this.http.post(`${p.N.path}/student/practical`,r).toPromise())});l.componentInstance?.formValueChange.subscribe(c=>{r=c.value}),l.componentInstance?.refreshSchema({properties:{name:{type:"string",title:"\u5b9e\u8df5\u540d\u79f0",ui:{widget:"string"}},unit:{type:"string",title:"\u5b9e\u8df5\u5355\u4f4d",ui:{widget:"string"}},start_time:{type:"string",title:"\u5f00\u59cb\u65f6\u95f4",ui:{widget:"date",mode:"date"}},end_time:{type:"string",title:"\u7ed3\u675f\u65f6\u95f4",ui:{widget:"date",mode:"date"}},describe:{type:"string",title:"\u5b9e\u8df5\u63cf\u8ff0",ui:{widget:"string"}}}}),l.componentInstance?.reset()}},{text:"\u6dfb\u52a0\u5bb6\u5ead\u6210\u5458",click:a=>{let r={};const l=this.modal.create({nzTitle:"\u6dfb\u52a0\u5bb6\u5ead\u6210\u5458",nzContent:u.kJ,nzComponentParams:{schema:{},formData:{},button:null},nzOnOk:()=>(r={...r,edges:{student:{id:a.id}}},this.http.post(`${p.N.path}/student/family`,r).toPromise())});l.componentInstance?.formValueChange.subscribe(c=>{r=c.value}),l.componentInstance?.refreshSchema({properties:{name:{type:"string",title:"\u5bb6\u5ead\u6210\u5458\u59d3\u540d",ui:{widget:"string"}},relationship:{type:"string",title:"\u4e0e\u5b66\u751f\u5173\u7cfb",ui:{widget:"string"}},id_card:{type:"string",title:"\u8eab\u4efd\u8bc1\u53f7",ui:{widget:"string"}},age:{type:"string",title:"\u5e74\u9f84",ui:{widget:"string"}},occupation:{type:"string",title:"\u804c\u4e1a",ui:{widget:"string"}},post:{type:"string",title:"\u804c\u52a1",ui:{widget:"string"}},work_unit:{type:"string",title:"\u5de5\u4f5c\u5355\u4f4d",ui:{widget:"string"}},contact_number:{type:"string",title:"\u8054\u7cfb\u7535\u8bdd",ui:{widget:"string"}},health:{type:"string",title:"\u5065\u5eb7\u72b6\u51b5",ui:{widget:"string"}}}}),l.componentInstance?.reset()}},{text:"\u6dfb\u52a0\u8bc1\u4e66\u4fe1\u606f",click:a=>{let r={};const l=this.modal.create({nzTitle:"\u6dfb\u52a0\u8bc1\u4e66",nzContent:u.kJ,nzComponentParams:{schema:{},formData:{},button:null},nzOnOk:()=>(r={...r,edges:{student:{id:a.id}}},this.http.post(`${p.N.path}/student/certificate`,r).toPromise())});l.componentInstance?.formValueChange.subscribe(c=>{r=c.value}),l.componentInstance?.refreshSchema({properties:{name:{type:"string",title:"\u8bc1\u4e66\u540d\u79f0",ui:{widget:"string"}},code:{type:"string",title:"\u8bc1\u4e66\u7f16\u53f7",ui:{widget:"string"}},description:{type:"string",title:"\u8bc1\u4e66\u63cf\u8ff0",ui:{widget:"string"}},department:{type:"string",title:"\u9881\u53d1\u673a\u6784",ui:{widget:"string"}},issue_date:{type:"string",title:"\u9881\u53d1\u65e5\u671f",ui:{widget:"date",mode:"date"}},certificate_type:{type:"string",title:"\u8bc1\u4e66\u7c7b\u578b",ui:{widget:"string"}},certificate_level:{type:"string",title:"\u8bc1\u4e66\u7ea7\u522b",ui:{widget:"string"}},certificate_type2:{type:"string",title:"\u8bc1\u4e66\u7c7b\u522b",ui:{widget:"string"}},award_category:{type:"string",title:"\u8bc1\u4e66\u7c7b\u522b\u7ec6\u5206",ui:{widget:"string"}}}}),l.componentInstance?.reset()}},{text:"\u5173\u8054\u73ed\u7ea7",click:a=>{let r={};const m={properties:{class:{title:"\u73ed\u7ea7",type:"string",ui:{widget:"select",asyncData:()=>this.http.get(`${p.N.path}/class`).pipe((0,h.U)(c=>c.body.map(b=>({label:b.name,value:b.id}))))}}}},l=this.modal.create({nzTitle:"\u5173\u8054\u7cfb\u90e8",nzContent:u.kJ,nzComponentParams:{schema:{properties:{}},formData:{department:a?.edges?.class?.id},button:null},nzOnOk:()=>(r={...a,edges:{class:{id:r.class}}},this.http.put(`${p.N.path}/student`,r).toPromise())});l.componentInstance?.formValueChange.subscribe(c=>{r=c.value}),l.componentInstance?.refreshSchema(m),l.componentInstance?.reset()}}],this.setInit()}studentAdd(){let e=[];this.modal.create({nzTitle:"\u6dfb\u52a0\u5b66\u751f",nzContent:w.b,nzWidth:800,nzComponentParams:{userSelect:n=>{e=n}},nzOnOk:()=>this.http.post(`${p.N.path}/student/batch`,e).toPromise().then(()=>{this.setInit(),this.simple?.query()})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.Sf),t.Y36(z.lP),t.Y36(I.S))},i.\u0275cmp=t.Xpm({type:i,selectors:[["student-list"]],viewQuery:function(e,n){if(1&e&&t.Gf(O,5),2&e){let s;t.iGM(s=t.CRH())&&(n.simple=s.first)}},decls:4,vars:6,consts:[["btn",""],[3,"template","buttons","schema","title","path","columns"],["simple",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e&&(t.YNc(0,Q,2,0,"ng-template",null,0,t.W1O),t._UZ(2,"app-simple",1,2)),2&e){const s=t.MAs(1);t.xp6(2),t.Q6J("template",s)("buttons",n.buttons)("schema",n.schema)("title",n.title)("path",n.path)("columns",n.columns)}},dependencies:[T.ix,N.w,P.dQ,A.B],encapsulation:2}),i})();var g=o(3596),J=o(2319),M=o(1971);function $(i,d){}let x=(()=>{class i{constructor(e,n){this.http=e,this.modal=n,this.columns=[{title:"\u59d3\u540d",index:"name",type:""},{title:"\u5e74\u9f84",index:"age",type:""},{title:"\u6027\u522b",index:"sex",type:""},{title:"\u8eab\u4efd\u8bc1\u53f7",index:"code",type:""},{type:"",title:"\u64cd\u4f5c",width:"100px",buttons:[{text:"\u67e5\u770b\u5b9e\u8df5\u7ecf\u5386",click:s=>{this.modal.create({nzTitle:"\u5b9e\u8df5\u4fe1\u606f",nzWidth:1200,nzContent:g.A5,nzComponentParams:{data:s.edges.practical_experience}}).componentInstance?.resetColumns({columns:[{title:"\u540d\u79f0",index:"name",type:""},{title:"\u5b9e\u8df5\u5355\u4f4d",index:"unit",type:""},{title:"\u5f00\u59cb\u65f6\u95f4",index:"start_time",type:""},{title:"\u7ed3\u675f\u65f6\u95f4",index:"end_time",type:""},{title:"\u5b9e\u8df5\u63cf\u8ff0",index:"string",type:""}]}),console.log(s)}},{text:"\u67e5\u770b\u5bb6\u5ead\u4fe1\u606f",click:s=>{this.modal.create({nzTitle:"\u5bb6\u5ead\u4fe1\u606f",nzWidth:1200,nzContent:g.A5,nzComponentParams:{data:s.edges.family_info}}).componentInstance?.resetColumns({columns:[{title:"\u5bb6\u5ead\u6210\u5458\u59d3\u540d",index:"name",type:""},{title:"\u4e0e\u5b66\u751f\u5173\u7cfb",index:"relationship",type:""},{title:"\u8eab\u4efd\u8bc1\u53f7",index:"id_card",type:""},{title:"\u5e74\u9f84",index:"age",type:""},{title:"\u804c\u4e1a",index:"occupation",type:""},{title:"\u804c\u52a1",index:"post",type:""},{title:"\u5de5\u4f5c\u5355\u4f4d",index:"work_unit",type:""},{title:"\u8054\u7cfb\u7535\u8bdd",index:"contact_number",type:""},{title:"\u5065\u5eb7\u72b6\u51b5",index:"health",type:""}]}),console.log(s)}},{text:"\u67e5\u770b\u8bc1\u4e66",click:s=>{this.modal.create({nzTitle:"\u8bc1\u4e66\u4fe1\u606f",nzWidth:1200,nzContent:g.A5,nzComponentParams:{data:s.edges.certificate}}).componentInstance?.resetColumns({columns:[{title:"\u540d\u79f0",index:"name",type:""},{title:"\u8bc1\u4e66\u7f16\u53f7",index:"code",type:""},{title:"\u8bc1\u4e66\u63cf\u8ff0",index:"description",type:""},{title:"\u9881\u53d1\u673a\u6784",index:"department",type:""},{title:"\u9881\u53d1\u65e5\u671f",index:"issue_date",type:""},{title:"\u8bc1\u4e66\u7c7b\u578b",index:"certificate_type",type:""},{title:"\u8bc1\u4e66\u7ea7\u522b",index:"certificate_level",type:""},{title:"\u8bc1\u4e66\u7c7b\u522b",index:"certificate_type2",type:""},{title:"\u8bc1\u4e66\u7c7b\u522b\u7ec6\u5206",index:"award_category",type:""}]})}}]}],this.data=[],this.temp_data=[],this.querySchema={properties:{role:{title:"\u89d2\u8272",type:"string",ui:{widget:"select",asyncData:()=>this.http.get(`${p.N.path}/role`).pipe((0,h.U)(s=>s.body.map(a=>({label:a.role_name,value:a.id}))))}},department:{title:"\u7cfb\u90e8",type:"string",ui:{widget:"select",asyncData:()=>this.http.get(`${p.N.path}/department`).pipe((0,h.U)(s=>s.body.map(a=>({label:a.name,value:a.id}))))}},major:{title:"\u4e13\u4e1a",type:"string",ui:{widget:"select",asyncData:()=>this.http.get(`${p.N.path}/major`).pipe((0,h.U)(s=>s.body.map(a=>({label:a.name,value:a.id}))))}},class:{title:"\u73ed\u7ea7",type:"string",ui:{widget:"select",asyncData:()=>this.http.get(`${p.N.path}/class`).pipe((0,h.U)(s=>s.body.map(a=>({label:a.name,value:a.id}))))}},name:{title:"\u540d\u79f0",type:"string",ui:{widget:"string"}}}}}ngOnInit(){this.query(null)}_onReuseInit(e){this.query(null)}query(e){this.http.get(`${p.N.path}/student`,e).subscribe(n=>{this.data=n.body,this.temp_data=n.body})}search(e){console.log(e),e.department&&(this.data=this.data.filter(n=>n.edges.department.id===e.department)),e.major&&(this.data=this.data.filter(n=>n.edges.major.id===e.major)),e.class&&(this.data=this.data.filter(n=>n.edges.class.id===e.class)),e.name&&(this.data=this.data.filter(n=>n.name.includes(e.name)))}reset(){this.data=this.temp_data}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(z.lP),t.Y36(f.Sf))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-student-query"]],decls:7,vars:4,consts:[[3,"action"],["phActionTpl",""],["layout","inline",3,"schema","formSubmit","formReset"],[3,"columns","data"],["st",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,$,0,0,"ng-template",null,1,t.W1O),t.TgZ(3,"sf",2),t.NdJ("formSubmit",function(a){return n.search(a)})("formReset",function(){return n.reset()}),t.qZA()(),t.TgZ(4,"nz-card"),t._UZ(5,"st",3,4),t.qZA()),2&e){const s=t.MAs(2);t.Q6J("action",s),t.xp6(3),t.Q6J("schema",n.querySchema),t.xp6(2),t.Q6J("columns",n.columns)("data",n.data)}},dependencies:[u.kJ,J.q,g.A5,M.bd],encapsulation:2}),i})();var S=o(9132);const D=[{path:"list",component:C},{path:"query",component:x}];let R=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[S.Bz.forChild(D),S.Bz]}),i})(),Z=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[v.m8,R]}),i})()}}]);